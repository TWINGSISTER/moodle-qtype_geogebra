{"version":3,"sources":["../src/ggbt.js"],"names":["define","$","GGBApplet","init","window","GGBT","ggbAppletOnLoad","val","JSON","stringify","applet1","getParameters","getViews","getHTML5CodebaseVersion","ggbcheckb","applet","document","ggbApplet","getXML","getExerciseResult","randomizedvar","getElementById","value","getrandvars","i","answer","on","e","preventDefault","update_feedback","target","querySelector","onkeypress","checkEnter","usefile","checked","style","display","ggbDataset","dataset","parameters","parse","views","setHTML5Codebase","lang","id","split","pop","indexOf","isNumber","substr","length","injectapplet","inject","ggbf","addEventListener","handleggbdisable","handleDragEnter","handleDragOver","handleDragEndLeave","handleDrop","handleusefile","initoptions","callback","params","elementname","M","core_filepicker","instances","options","url","file","language","moodle","useBrowserForJS","objNumber","getObjectNumber","stringforrandomizedvars","j","strName","getObjectName","getObjectType","isIndependent","answernode","attr","varname","feedback","feedbackfromfile","doc","parseXML","elem","getElementsByTagName","fbstring","getAttribute","event","txtArea","test","srcElement","tagName","keyCode","which","charCode","enable_right_click","enable_label_drags","show_reset_icon","enable_shift_drag_zoom","show_algebra_input","show_menu_bar","show_tool_bar","enableRightClick","enableLabelDrags","showResetIcon","enableShiftDragZoom","showAlgebraInput","showMenuBar","showToolBar","handlesettingschanged","evt","click","classList","add","visibility","remove","removeProperty","stopPropagation","dataTransfer","files","height","reader","FileReader","onload","base64","result","replace","readAsDataURL","n","isNaN","parseFloat","isFinite"],"mappings":"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","sourcesContent":["/**\n * Javascript Controller to embed GGBApplet\n *\n * This class provides all the functionality for the new assign module.\n *\n * @package        assignsubmission_geogebra\n * @author         Christoph Stadlbauer <christoph.stadlbauer@geogebra.org>\n * @copyright  (c) International GeoGebra Institute 2018\n * @license        http://www.geogebra.org/license\n */\ndefine(['jquery', '//www.geogebra.org/apps/deployggb.js'], function($, GGBApplet) {\n    /**\n     * Created by Christoph on 25.08.19.\n     */\n    return {\n\n        init: function() {\n            window.GGBT = this;\n            window.ggbAppletOnLoad = function() {\n                $('input[name=\"ggbparameters\"]').val(JSON.stringify(window.applet1.getParameters()));\n                $('input[name=\"ggbviews\"]').val(JSON.stringify(window.applet1.getViews()));\n                $('input[name=\"ggbcodebaseversion\"]').val(window.applet1.getHTML5CodebaseVersion());\n\n                if (typeof (this.ggbcheckb) == \"undefined\") {\n                    var applet = document.ggbApplet;\n                    $('input[name=\"ggbxml\"]').val(applet.getXML());\n                    $('input[name=\"ggbexercise\"]').val(JSON.stringify(applet.getExerciseResult()));\n\n                    var randomizedvar = document.getElementById('id_randomizedvar');\n                    if (!randomizedvar.value) {\n                        window.GGBT.getrandvars();\n                    }\n\n                    var i = 0;\n                    var answer = $('#id_answer_' + i);\n                    while (answer[0] !== undefined) {\n                        if (answer.val()) {\n                            answer.on('change focus', function(e) {\n                                e.preventDefault();\n                                window.GGBT.update_feedback($(e.target));\n                            });\n                            window.GGBT.update_feedback(answer);\n                        }\n                        answer = $('#id_answer_' + ++i);\n                    }\n                    document.querySelector('article').onkeypress = window.GGBT.checkEnter;\n                }\n                if (window.GGBT.usefile.checked) {\n                    document.getElementById('applet_container1').style.display = \"block\";\n                    document.getElementById('applet_options').style.display = \"flex\";\n                }\n            };\n\n            if ($('#applet_parameters')[0] !== undefined) {\n                this.ggbDataset = $('#applet_parameters')[0].dataset;\n                this.parameters = JSON.parse(this.ggbDataset.parameters);\n                this.views = this.ggbDataset.views;\n                window.applet1 = new GGBApplet(this.parameters, this.views, true);\n                window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.410.0/web3d\");\n                this.lang = this.ggbDataset.lang;\n            }\n\n            $('#id_loadapplet').on('click', function(e) {\n                e.preventDefault();\n                var id = $('#id_ggbturl').val().split(\"/\").pop();\n                if (id.indexOf(\"m\") == 0) {\n                    if (window.GGBT.isNumber(id.substr(1)) || (!window.GGBT.isNumber(id.substr(1)) && id.length > 8)) {\n                        id = id.substr(1);\n                    }\n                }\n                window.GGBT.injectapplet(id);\n            });\n\n            $('#id_getvars').on('click', function(e) {\n                e.preventDefault();\n                window.GGBT.getrandvars();\n            });\n\n            if (this.parameters) {\n                window.applet1.inject(\"applet_container1\", \"preferHTML5\");\n            }\n\n            this.ggbf = document.getElementById('id_ggbtheader');\n            this.usefile = document.getElementById(\"id_usefile\");\n\n            if (this.ggbf === null) { // In this case we are editing a submission.\n                this.ggbf = document.getElementById('id_submissiontypes');\n                this.ggbcheckb = document.getElementById('id_assignsubmission_geogebra_enabled');\n                if (this.ggbcheckb !== null) {\n                    this.ggbcheckb.addEventListener('change', this.handleggbdisable, false);\n                }\n            }\n\n            if (this.ggbf !== null) {\n                this.ggbf.addEventListener('dragenter', this.handleDragEnter, false);\n                this.ggbf.addEventListener('dragover', this.handleDragOver, false);\n                this.ggbf.addEventListener('dragleave', this.handleDragEndLeave, false);\n                this.ggbf.addEventListener('dragend', this.handleDragEndLeave, false);\n                this.ggbf.addEventListener('drop', this.handleDrop, false);\n                this.usefile.addEventListener('change', this.handleusefile, false);\n            }\n\n            if (this.usefile.checked) {\n                document.getElementById('applet_options').style.display = \"block\";\n            } else {\n                document.getElementById('applet_options').style.display = \"none\";\n            }\n            this.initoptions();\n        },\n\n        callback: function(params) {\n            var elementname = M.core_filepicker.instances[params['client_id']].options.elementname;\n            $('#id_' + elementname).val(params.url);\n            // inject applet to div layer\n            var id = (params.file).split(\".\")[0];\n            if (id.indexOf(\"m\") == 0) {\n                if (this.isNumber(id.substr(1)) || (!this.isNumber(id.substr(1)) && id.length > 8)) {\n                    id = id.substr(1);\n                }\n            }\n            this.injectapplet(id);\n        },\n\n        injectapplet: function(id) {\n            this.parameters = {\"material_id\": id};\n            this.parameters.language = this.lang;\n            this.parameters.moodle = \"editingQuestionOrSubmission\";\n            // Since we only support HTML5 this should work for js-code in the applet to get executed (ggboninit).\n            this.parameters.useBrowserForJS = false;\n\n            document.getElementById('applet_container1').style.display = \"block\";\n\n            window.applet1 = new GGBApplet(this.parameters, true);\n            window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.541.0/web3d\");\n\n            window.applet1.inject(\"applet_container1\", \"preferHTML5\");\n\n        },\n\n        getrandvars: function() {\n            var applet = document.ggbApplet;\n            if (typeof applet !== 'undefined') {\n                var objNumber = applet.getObjectNumber();\n                var randomizedvar = document.getElementById('id_randomizedvar');\n                var stringforrandomizedvars = \"\";\n                var i = 0;\n                for (var j = 0; j < objNumber; j++) {\n                    var strName = applet.getObjectName(j);\n                    if (applet.getObjectType(strName) == \"numeric\" && applet.isIndependent(strName)) {\n                        stringforrandomizedvars += strName + \",\";\n                    } else {\n                        var answer = $('#id_answer_' + i);\n                        if (applet.getObjectType(strName) == \"boolean\") {\n                            if (answer !== null) {\n                                if (!answer.val()) {\n                                    answer.val(strName);\n                                }\n                                this.update_feedback(answer);\n                                i++;\n                            }\n                        }\n                    }\n                    randomizedvar.value = stringforrandomizedvars;\n                }\n            }\n        },\n\n        update_feedback: function(answernode) {\n            var id = answernode.attr('id').split(\"_\").pop();\n            var varname = answernode.val();\n            var feedback = $('input[name=\"feedback[' + id + ']\"]');\n            var feedbackfromfile = $('#id_feedbackfromfile_' + id);\n            var doc = $.parseXML(window.ggbApplet.getXML(varname));\n            if (doc) {\n                var elem = doc.getElementsByTagName('caption');\n                var fbstring = '';\n                if (elem.length == 1) {\n                    fbstring = elem[0].getAttribute('val');\n                    feedback.val(fbstring);\n                } else if (elem.length > 1) {\n                    feedback.val('');\n                    fbstring = '';\n                } else {\n                    feedback.val('');\n                    //this is rather an error condition but should be checked by the server\n                    fbstring = 'Caption not set or variable name wrong.';\n                }\n                feedbackfromfile.val(fbstring);\n            }\n        },\n\n        checkEnter: function(e) {\n            e = e || event;\n            var txtArea = /textarea/i.test((e.target || e.srcElement).tagName);\n            return txtArea || (e.keyCode || e.which || e.charCode || 0) !== 13;\n        },\n\n        initoptions: function() {\n            this.enable_right_click = document.getElementById('enableRightClick');\n            this.enable_label_drags = document.getElementById('enableLabelDrags');\n            this.show_reset_icon = document.getElementById('showResetIcon');\n            this.enable_shift_drag_zoom = document.getElementById('enableShiftDragZoom');\n            this.show_algebra_input = document.getElementById('showAlgebraInput');\n            this.show_menu_bar = document.getElementById('showMenuBar');\n            this.show_tool_bar = document.getElementById('showToolBar');\n\n            if (typeof parameters !== 'undefined') {\n                this.enable_right_click.checked = this.parameters.enableRightClick;\n                this.enable_label_drags.checked = this.parameters.enableLabelDrags;\n                this.show_reset_icon.checked = this.parameters.showResetIcon;\n                this.enable_shift_drag_zoom.checked = this.parameters.enableShiftDragZoom;\n                this.show_algebra_input.checked = this.parameters.showAlgebraInput;\n                this.show_menu_bar.checked = this.parameters.showMenuBar;\n                this.show_tool_bar.checked = this.parameters.showToolBar;\n            }\n\n            this.enable_right_click.addEventListener('change', this.handlesettingschanged, false);\n            this.enable_label_drags.addEventListener('change', this.handlesettingschanged, false);\n            this.show_reset_icon.addEventListener('change', this.handlesettingschanged, false);\n            this.enable_shift_drag_zoom.addEventListener('change', this.handlesettingschanged, false);\n            this.show_algebra_input.addEventListener('change', this.handlesettingschanged, false);\n            this.show_menu_bar.addEventListener('change', this.handlesettingschanged, false);\n            this.show_tool_bar.addEventListener('change', this.handlesettingschanged, false);\n        },\n\n        handlesettingschanged: function(evt) {\n            window.GGBT.parameters[evt.target.id] = (evt.target.checked);\n            $('input[name=\"ggbparameters\"]').val(JSON.stringify(window.GGBT.parameters));\n            if (evt.target.id == \"showToolBar\" || evt.target.id == \"showMenuBar\" || evt.target.id == \"showAlgebraInput\") {\n                window.applet1 = new GGBApplet(window.GGBT.parameters, true);\n                window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.541.0/web3d\");\n                window.applet1.inject(\"applet_container1\", \"preferHTML5\");\n            } else {\n                window.ggbApplet[evt.target.id](evt.target.checked);\n            }\n        },\n\n        handleusefile: function() {\n            if (!window.GGBT.usefile.checked) {\n                document.getElementById('applet_container1').style.display = \"none\";\n                document.getElementById('applet_options').style.display = \"none\";\n            } else {\n                document.getElementById('id_ggbturl').value = \"\";\n                // document.getElementById('applet_container1').style.display = \"block\";\n            }\n        },\n\n        handleggbdisable: function() {\n            if (!window.GGBT.ggbcheckb.checked) {\n                document.getElementById('applet_container1').style.display = \"none\";\n                document.getElementById('applet_options').style.display = \"none\";\n                if (window.GGBT.usefile.checked) {\n                    window.GGBT.usefile.click();\n                }\n            } else {\n                document.getElementById('applet_container1').style.display = \"block\";\n            }\n        },\n\n        handleDragEnter: function() {\n            if (typeof (ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\n                window.GGBT.ggbf.classList.add('qtype-geogebra-hover');\n                document.getElementById('applet_container1').style.visibility = \"hidden\";\n            }\n        },\n\n        handleDragOver: function(e) {\n            if (typeof (window.GGBT.ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\n                if (e.preventDefault) {\n                    e.preventDefault();\n                }\n                window.GGBT.ggbf.classList.add('qtype-geogebra-hover');\n                document.getElementById('applet_container1').style.visibility = \"hidden\";\n                return false;\n            }\n        },\n\n        handleDragEndLeave: function() {\n            if (typeof (window.GGBT.ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\n                window.GGBT.ggbf.classList.remove('qtype-geogebra-hover');\n                document.getElementById('applet_container1').style.removeProperty(\"visibility\");\n            }\n        },\n\n        handleDrop: function(e) {\n            if (typeof (window.GGBT.ggbcheckb) == \"undefined\" || window.GGBT.ggbcheckb.checked) {\n                e.preventDefault();\n                e.stopPropagation();\n                var file = e.dataTransfer.files[0];\n                window.GGBT.ggbf.classList.remove('qtype-geogebra-hover');\n                document.getElementById('applet_container1').style.removeProperty(\"visibility\");\n                document.getElementById('applet_container1').style.display = \"block\";\n                document.getElementById('applet_options').style.display = \"flex\";\n                document.getElementById('applet_container1').style.height = \"100%\";\n                //document.getElementById('applet_container1').style.width = \"100%\";\n\n                document.getElementById('id_ggbturl').value = \"\";\n                //this.usefile = document.getElementById(\"id_usefile\");\n                if (!window.GGBT.usefile.checked) {\n                    window.GGBT.usefile.click();\n                }\n                var reader = new FileReader();\n                reader.onload = function(event) {\n                    var base64 = event.target.result.replace(\"data:application/vnd.geogebra.file;base64,\", \"\");\n                    window.GGBT.parameters = {\"ggbBase64\": base64};\n                    window.GGBT.parameters.enableRightClick = window.GGBT.enable_right_click.checked;\n                    window.GGBT.parameters.enableLabelDrags = window.GGBT.enable_label_drags.checked;\n                    window.GGBT.parameters.showResetIcon = window.GGBT.show_reset_icon.checked;\n                    window.GGBT.parameters.enableShiftDragZoom = window.GGBT.enable_shift_drag_zoom.checked;\n                    window.GGBT.parameters.showAlgebraInput = window.GGBT.show_algebra_input.checked;\n                    window.GGBT.parameters.showMenuBar = window.GGBT.show_menu_bar.checked;\n                    window.GGBT.parameters.showToolBar = window.GGBT.show_tool_bar.checked;\n                    window.GGBT.parameters.moodle = \"editingQuestionOrSubmission\";\n                    window.applet1 = new GGBApplet(window.GGBT.parameters, true);\n                    window.applet1.setHTML5Codebase(\"https://cdn.geogebra.org/apps/5.0.541.0/web3d\");\n                    window.applet1.inject(\"applet_container1\");\n                };\n\n                reader.readAsDataURL(file);\n            }\n        },\n\n        isNumber: function(n) {\n            return !isNaN(parseFloat(n)) && isFinite(n);\n        }\n    };\n});\n"],"file":"ggbt.min.js"}